# This file configures a semantic checker to validate code implementations against their specifications.
# It maps the relation between code and specification, use it to find which code to update when changing specs.
version: "1.0"

provider: "openai"
model: "gpt-4.1"
api_key: "${OPENAI_API_KEY}"
timeout: 300
max_retries: 3
fail_on_issues: true

rules:
  - name: "config-file-definition"
    description: "Make sure config files are implemented according to spec"
    enabled: true
    files:
      include:
        - "./internal/config/*.go"
      exclude:
        - "./internal/config/*_test.go"
    specs:
      - path: "./specs/semcheck.md"
    severity: "error"
  
  - name: "readme-file"
    description: "Make sure examples in the readme make sense"
    enabled: true
    files:
      include:
        - "./README.md"
    prompt: |
      Make sure the example config, cli arguments and Justfile commands in this README file match the actual code and Justfile.
      The README does not have to document every field in the config or document every default value.
    specs:
      - path: "./internal/config/config.go" # Configuration example
      - path: "./Justfile"  # Justfile instructions
      - path: "./cmd/cli/cli.go" # Command line interface
    severity: "error"
